<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SupremeAmer — Telegram Mini App</title>
  <style>
    :root{
      --bg:#0b1020; --card:#0f1724; --accent:#ffb86b; --muted:#96a0b8; --glass: rgba(255,255,255,0.04);
      --sat-size:72px;
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    html,body,#app{height:100%;margin:0;background:linear-gradient(180deg,#06070b 0%, #071022 60%);color:#e6eef8}
    .app{max-width:480px;margin:0 auto;display:flex;flex-direction:column;height:100%;padding:12px}/* header */
header{display:flex;align-items:center;gap:12px;padding:8px 4px}
.brand{display:flex;align-items:center;gap:8px}
.logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#ffd37a,#ff7ea6);display:flex;align-items:center;justify-content:center;font-weight:700;color:#0b1020}
.title{font-size:16px;font-weight:700}
.subtitle{font-size:12px;color:var(--muted)}

/* main card */
.card{background:var(--card);border-radius:16px;padding:16px;margin-top:10px;box-shadow:0 8px 30px rgba(4,8,20,0.6)}

/* mining area */
.mining-wrap{display:flex;gap:12px;align-items:center}
.sat-visual{width:var(--sat-size);height:var(--sat-size);border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff7d9 0%, #ffd37a 20%, #ffb86b 45%, #ff7e6d 100%);display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 6px 20px rgba(255,184,107,0.12)}
.sat-visual .coin{width:60%;height:60%;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;color:#2b1b07}

/* rotation */
.rotating{animation:spin 2.2s linear infinite}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

/* vapour/fire */
.vapour{position:absolute;left:50%;transform:translateX(-50%);bottom:-20px;width:80px;height:40px;pointer-events:none;}
.vapour .flame{position:absolute;left:50%;transform:translateX(-50%);bottom:0;width:10px;height:10px;border-radius:50%;opacity:0.9;filter:blur(8px);animation:rise 1.2s ease-in-out infinite}
.vapour .f1{background:rgba(255,180,110,0.9);animation-delay:0s}
.vapour .f2{background:rgba(255,110,80,0.7);width:14px;height:14px;animation-delay:0.15s}
.vapour .f3{background:rgba(255,230,150,0.6);width:22px;height:22px;animation-delay:0.28s}
@keyframes rise{0%{transform:translate(-50%,6px) scale(0.8);opacity:0.6}50%{transform:translate(-50%,-6px) scale(1.05);opacity:1}100%{transform:translate(-50%,-26px) scale(0.6);opacity:0}}

.stats{flex:1}
.stat-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0}
.big{font-size:18px;font-weight:700}
.muted{color:var(--muted);font-size:12px}

.progress{height:12px;background:var(--glass);border-radius:999px;overflow:hidden;margin-top:8px}
.progress > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#ffb86b,#ff7ea6)}

.controls{display:flex;gap:8px;margin-top:12px}
.btn{flex:1;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);border:1px solid rgba(255,255,255,0.03);text-align:center;font-weight:700}
.btn.primary{background:linear-gradient(90deg,#ffb86b,#ff7ea6);color:#0b1020}

/* tabs */
.tabs{display:flex;gap:8px;margin-top:12px}
.tab{flex:1;padding:10px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.03);text-align:center;font-weight:700}
.tab.active{background:linear-gradient(90deg,#0f1724,#122035);border:1px solid rgba(255,255,255,0.05)}

/* tasks list */
.tasks-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px}
.task{padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);font-size:13px}
.task small{display:block;color:var(--muted);font-size:11px}
.task .ok{margin-top:8px;padding:6px;border-radius:8px;background:rgba(255,255,255,0.03);font-weight:700;text-align:center}

/* wallet */
.wallet-form{display:flex;gap:8px;margin-top:8px}
input[type=text]{flex:1;padding:10px;border-radius:10px;background:#07122a;border:1px solid rgba(255,255,255,0.03);color:inherit}

/* footer nav */
footer{position:fixed;left:0;right:0;bottom:8px;display:flex;justify-content:center}
.nav{width:100%;max-width:480px;padding:6px 12px;background:transparent;display:flex;gap:8px}
.nav button{flex:1;padding:12px;border-radius:12px;background:linear-gradient(90deg,#0b1220,#071022);border:1px solid rgba(255,255,255,0.03);font-weight:800}

/* responsive small tweaks */
@media(min-width:520px){.app{margin-top:24px}}

  </style>
</head>
<body>
  <div id="app" class="app">
    <header>
      <div class="brand">
        <div class="logo">S</div>
        <div>
          <div class="title">SupremeAmer Network</div>
          <div class="subtitle">Mine SAT • Complete tasks • Earn</div>
        </div>
      </div>
      <div style="margin-left:auto;text-align:right">
        <div id="userTag" class="muted">Not connected</div>
      </div>
    </header><main class="card" id="mainCard">
  <!-- Mining View -->
  <div id="miningView">
    <div class="mining-wrap">
      <div style="position:relative">
        <div id="satVisual" class="sat-visual">
          <div class="coin rotating" id="coin">SAT</div>
          <div class="vapour" id="vapour" style="display:none">
            <div class="flame f3"></div>
            <div class="flame f2"></div>
            <div class="flame f1"></div>
          </div>
        </div>
      </div>
      <div class="stats">
        <div class="stat-row"><div class="muted">Mining speed</div><div id="speedDisplay" class="big">0.2 SAT/hr</div></div>
        <div class="stat-row"><div class="muted">Total mined</div><div id="totalMined" class="big">0 SAT</div></div>
        <div class="stat-row"><div class="muted">Today's mined</div><div id="dailyMined" class="big">0 SAT</div></div>
        <div class="muted">24h progress</div>
        <div class="progress"><i id="progressFill"></i></div>
        <div class="controls">
          <div class="btn primary" id="claimBtn">Claim (available)</div>
          <div class="btn" id="upgradeBtn">Upgrade 0.8/hr • 0.0009 BNB</div>
        </div>
      </div>
    </div>

    <div style="margin-top:14px;display:flex;gap:8px;align-items:center;justify-content:space-between">
      <div class="muted">Streak: <span id="streak">0</span> days</div>
      <div class="muted">Next reward: <span id="nextReward">1 SAT</span></div>
    </div>
  </div>

  <!-- Earn / Tasks View (hidden by default) -->
  <div id="earnView" style="display:none">
    <h3 style="margin-top:8px">Earn — Tasks & Referrals</h3>
    <div style="display:flex;gap:8px;margin-top:8px">
      <div style="flex:1;padding:8px;background:rgba(255,255,255,0.02);border-radius:10px">
        <div class="muted">Referral link</div>
        <div id="refLink" style="word-break:break-all;margin-top:6px;font-weight:700">—</div>
        <div class="muted" style="font-size:12px;margin-top:6px">Get +1 SAT for each referred user after they claim first time.</div>
      </div>
    </div>

    <h4 style="margin-top:10px">Tasks</h4>
    <div class="tasks-grid" id="tasksGrid">
      <!-- tasks injected here -->
    </div>
  </div>

  <!-- Wallet View -->
  <div id="walletView" style="display:none">
    <h3>Wallet</h3>
    <div class="muted">Connect BNB wallet (paste address or use WalletConnect in your bot)</div>
    <div class="wallet-form">
      <input type="text" id="walletInput" placeholder="0x... or BNB address" />
      <button class="btn" id="saveWallet">Save</button>
    </div>
    <div style="margin-top:10px"><strong>Connected:</strong> <span id="walletAddr">Not connected</span></div>
  </div>

</main>

<footer>
  <div class="nav">
    <button class="tab active" id="tabMining">Mining</button>
    <button class="tab" id="tabEarn">Earn</button>
    <button class="tab" id="tabWallet">Wallet</button>
  </div>
</footer>

  </div>  <script>
    /* ---------- Configuration & constants ---------- */
    const DEFAULT_SPEED_HR = 0.2; // sat per hour
    const UPGRADED_SPEED_HR = 0.8;
    const UPGRADE_PRICE_BNB = 0.0009;
    const CLAIM_INTERVAL_MS = 24 * 60 * 60 * 1000; // 24h
    const TASK_REWARD = 0.1; // sat per task

    // derived
    const DEFAULT_SPEED_S = DEFAULT_SPEED_HR / 3600; // sat per second
    const UPGRADED_SPEED_S = UPGRADED_SPEED_HR / 3600;

    /* ---------- Simple local storage App state (replace with Appwrite on backend) ---------- */
    const state = {
      totalMined: Number(localStorage.getItem('totalMined')) || 0,
      dailyMined: Number(localStorage.getItem('dailyMined')) || 0,
      miningSpeedPerSec: Number(localStorage.getItem('miningSpeedPerSec')) || DEFAULT_SPEED_S,
      miningStartedAt: Number(localStorage.getItem('miningStartedAt')) || Date.now(),
      lastClaimAt: Number(localStorage.getItem('lastClaimAt')) || 0,
      streak: Number(localStorage.getItem('streak')) || 0,
      lastClaimDate: localStorage.getItem('lastClaimDate') || null,
      walletAddr: localStorage.getItem('walletAddr') || '',
      tasksCompleted: JSON.parse(localStorage.getItem('tasksCompleted') || '[]')
    };

    /* ---------- UI refs ---------- */
    const totalMinedEl = document.getElementById('totalMined');
    const dailyMinedEl = document.getElementById('dailyMined');
    const speedDisplayEl = document.getElementById('speedDisplay');
    const progressFillEl = document.getElementById('progressFill');
    const vapourEl = document.getElementById('vapour');
    const claimBtn = document.getElementById('claimBtn');
    const upgradeBtn = document.getElementById('upgradeBtn');
    const streakEl = document.getElementById('streak');
    const nextRewardEl = document.getElementById('nextReward');
    const walletAddrEl = document.getElementById('walletAddr');
    const walletInput = document.getElementById('walletInput');
    const saveWalletBtn = document.getElementById('saveWallet');

    /* Tabs */
    const tabMining = document.getElementById('tabMining');
    const tabEarn = document.getElementById('tabEarn');
    const tabWallet = document.getElementById('tabWallet');
    const miningView = document.getElementById('miningView');
    const earnView = document.getElementById('earnView');
    const walletView = document.getElementById('walletView');

    /* Tasks */
    const tasksGrid = document.getElementById('tasksGrid');

    /* ---------- Helper functions ---------- */
    function saveState(){
      localStorage.setItem('totalMined', state.totalMined);
      localStorage.setItem('dailyMined', state.dailyMined);
      localStorage.setItem('miningSpeedPerSec', state.miningSpeedPerSec);
      localStorage.setItem('miningStartedAt', state.miningStartedAt);
      localStorage.setItem('lastClaimAt', state.lastClaimAt);
      localStorage.setItem('streak', state.streak);
      localStorage.setItem('lastClaimDate', state.lastClaimDate);
      localStorage.setItem('walletAddr', state.walletAddr);
      localStorage.setItem('tasksCompleted', JSON.stringify(state.tasksCompleted));
    }

    function formatSat(n){ return (Math.round((n+Number.EPSILON)*1000000)/1000000).toString().replace(/\.0+$/,'') }

    /* ---------- Mining loop (client-side) ---------- */
    let lastTick = Date.now();
    function tick(){
      const now = Date.now();
      const dt = (now - lastTick) / 1000; // seconds
      lastTick = now;

      // Add mining progress
      const add = state.miningSpeedPerSec * dt;
      state.totalMined += add;

      // Check day rollover for dailyMined
      const utcNow = new Date();
      const todayKey = utcNow.toISOString().slice(0,10);
      if(state._dailyKey !== todayKey){ state._dailyKey = todayKey; state.dailyMined = 0; }
      state.dailyMined += add;

      // Update UI
      totalMinedEl.textContent = formatSat(state.totalMined) + ' SAT';
      dailyMinedEl.textContent = formatSat(state.dailyMined) + ' SAT';
      const secondsSinceStartOfDay = (utcNow.getHours()*3600 + utcNow.getMinutes()*60 + utcNow.getSeconds());
      const progressPercent = Math.min(100, ((secondsSinceStartOfDay) / 86400) * 100); // approximate daily progress into 24h
      progressFillEl.style.width = progressPercent + '%';

      // Vapour animation active while mining (always active here)
      vapourEl.style.display = state.miningSpeedPerSec > 0 ? 'block':'none';

      // Save occasionally (throttle)
      if(now % 5000 < 50) saveState();

      requestAnimationFrame(tick);
    }

    /* ---------- Claim logic ---------- */
    function canClaim(){
      const now = Date.now();
      return (now - state.lastClaimAt) >= CLAIM_INTERVAL_MS;
    }

    function updateClaimButton(){
      if(canClaim()){
        claimBtn.textContent = 'Claim (available)';
        claimBtn.classList.add('primary');
      } else {
        // show time remaining
        const left = CLAIM_INTERVAL_MS - (Date.now() - state.lastClaimAt);
        const hrs = Math.floor(left/3600000); const mins = Math.floor((left%3600000)/60000);
        claimBtn.textContent = `Claim available in ${hrs}h ${mins}m`;
        claimBtn.classList.remove('primary');
      }
    }

    claimBtn.addEventListener('click', ()=>{
      if(!canClaim()) return updateClaimButton();
      // credit the user daily mined
      const amount = Math.max(0, state.dailyMined);
      // Award daily streak reward
      const todayKey = new Date().toISOString().slice(0,10);
      if(state.lastClaimDate === todayKey){
        // already claimed today (shouldn't happen due to 24h rule) - just return
        return alert('You have already claimed today.');
      }

      // Update streak: if last claim was yesterday then increment, otherwise reset
      const yesterday = new Date(); yesterday.setDate(yesterday.getDate()-1);
      const yesterdayKey = yesterday.toISOString().slice(0,10);
      if(state.lastClaimDate === yesterdayKey){ state.streak = Math.min(90, state.streak + 1); }
      else { state.streak = 1; }

      // Daily streak reward: 1..500 over 1..90 days (simple linear mapping)
      const reward = Math.min(500, Math.max(1, Math.round((state.streak/90) * 500)));

      // Add base claim (the day's mined) + streak reward
      const totalAward = amount + reward;
      state.totalMined += reward; // reward in SAT

      // Reset daily counters
      state.dailyMined = 0;
      state.lastClaimAt = Date.now();
      state.lastClaimDate = todayKey;

      saveState(); updateClaimButton();
      alert(`Claim successful! You received your day's mining + streak reward: ${formatSat(totalAward)} SAT (includes ${reward} SAT streak reward).`)
    });

    setInterval(updateClaimButton, 30000);

    /* ---------- Upgrade flow (simulated) ---------- */
    upgradeBtn.addEventListener('click', async ()=>{
      if(!state.walletAddr){
        if(!confirm('To upgrade you must connect your wallet. Save wallet address now?')) return;
        if(walletInput.value) { state.walletAddr = walletInput.value.trim(); saveState(); refreshWalletUI(); }
        else return alert('Please paste your BNB address first.')
      }

      // NOTE: production - trigger real on-chain payment flow (BNB) and verify tx. Here we simulate.
      const ok = confirm(`Upgrade mining speed to ${UPGRADED_SPEED_HR} SAT/hr for ${UPGRADE_PRICE_BNB} BNB? (This demo simulates payment)`);
      if(!ok) return;
      // TODO: verify BNB tx using backend; after verification set upgrade expiry
      state.miningSpeedPerSec = UPGRADED_SPEED_S;
      state._upgradeExpires = Date.now() + (30*24*60*60*1000); // 30 days
      saveState();
      speedDisplayEl.textContent = `${UPGRADED_SPEED_HR} SAT/hr (upgraded)`;
      alert('Upgrade applied (simulated). In production you must verify an on-chain payment before upgrading.');
    });

    /* ---------- Wallet save ---------- */
    saveWalletBtn.addEventListener('click', ()=>{
      const v = walletInput.value.trim();
      if(!v) return alert('Paste your wallet address');
      state.walletAddr = v; saveState(); refreshWalletUI();
      alert('Wallet saved locally. For real payments use WalletConnect or on-chain verification.');
    });

    function refreshWalletUI(){
      walletAddrEl.textContent = state.walletAddr ? state.walletAddr : 'Not connected';
      walletInput.value = state.walletAddr || '';
    }

    /* ---------- Tabs handling ---------- */
    tabMining.addEventListener('click', ()=>{switchTab('mining')});
    tabEarn.addEventListener('click', ()=>{switchTab('earn')});
    tabWallet.addEventListener('click', ()=>{switchTab('wallet')});

    function switchTab(tab){
      tabMining.classList.remove('active'); tabEarn.classList.remove('active'); tabWallet.classList.remove('active');
      miningView.style.display='none'; earnView.style.display='none'; walletView.style.display='none';
      if(tab==='mining'){ tabMining.classList.add('active'); miningView.style.display='block'; }
      if(tab==='earn'){ tabEarn.classList.add('active'); earnView.style.display='block'; }
      if(tab==='wallet'){ tabWallet.classList.add('active'); walletView.style.display='block'; }
    }

    /* ---------- Tasks list (sample categories & tasks) ---------- */
    const TASKS = [
      {id:'social_join',cat:'Social',title:'Join Telegram Channel',desc:'Join our main channel',reward: TASK_REWARD},
      {id:'follow_x',cat:'Social',title:'Follow on X/Twitter',desc:'Follow @SupremeAmer',reward: TASK_REWARD},
      {id:'watch_vid',cat:'Engagement',title:'Watch Promo Video',desc:'Watch 30s promo',reward: TASK_REWARD},
      {id:'visit_partner',cat:'Partners',title:'Visit Partner Site',desc:'Visit link and stay 20s',reward: TASK_REWARD},
      {id:'invite',cat:'Referral',title:'Invite a Friend',desc:'Share your referral link',reward: 1}
    ];

    function renderTasks(){
      tasksGrid.innerHTML='';
      TASKS.forEach(t=>{
        const done = state.tasksCompleted.includes(t.id);
        const el = document.createElement('div'); el.className='task';
        el.innerHTML = `<strong>${t.title}</strong><small>${t.desc}</small><div style=\"margin-top:8px;display:flex;gap:6px\">`+
          `<div style=\"flex:1;font-weight:700\">${t.reward} SAT</div>`+
          `<div style=\"width:110px\"><button class=\"ok\" data-id=\"${t.id}\">${done? 'Completed' : 'Do Task'}</button></div>`+
        `</div>`;
        tasksGrid.appendChild(el);
      });

      // attach handlers
      document.querySelectorAll('.ok').forEach(btn=>btn.addEventListener('click', async (e)=>{
        const id = e.currentTarget.dataset.id; if(state.tasksCompleted.includes(id)) return alert('Already completed.');
        // In production: verify with backend (e.g. check channel membership / tx) before crediting.
        // Here we simulate immediate credit.
        state.tasksCompleted.push(id);
        // credit reward
        const t = TASKS.find(x=>x.id===id);
        state.totalMined += t.reward;
        saveState(); renderTasks();
        alert(`Task completed: +${t.reward} SAT`);
      }));
    }

    /* ---------- Referral link (basic) ---------- */
    function buildReferralLink(){
      // If inside Telegram WebApp we may get user id via initData - left as placeholder
      const user = (window.Telegram && Telegram.WebApp && Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) ? Telegram.WebApp.initDataUnsafe.user : null;
      const uid = user ? (user.id || 'guest') : (localStorage.getItem('supremeUserId') || 'guest');
      const base = 'https://t.me/YourBot?start=';
      const ref = `${base}ref_${uid}`;
      return ref;
    }

    /* ---------- Init ---------- */
    function init(){
      // If we had server-side Appwrite, we'd load real user data here.
      speedDisplayEl.textContent = state.miningSpeedPerSec === UPGRADED_SPEED_S ? `${UPGRADED_SPEED_HR} SAT/hr (upgraded)` : `${DEFAULT_SPEED_HR} SAT/hr`;
      streakEl.textContent = state.streak;
      nextRewardEl.textContent = Math.min(500, Math.max(1, Math.round((state.streak/90) * 500))) + ' SAT';
      refreshWalletUI();
      document.getElementById('refLink').textContent = buildReferralLink();
      renderTasks();
      requestAnimationFrame(tick);
      setInterval(()=>{ // update small ui pieces regularly
        document.getElementById('speedDisplay').textContent = (state.miningSpeedPerSec * 3600).toFixed(2) + ' SAT/hr';
        updateClaimButton();
        streakEl.textContent = state.streak;
        nextRewardEl.textContent = Math.min(500, Math.max(1, Math.round((state.streak/90) * 500))) + ' SAT';
      }, 2000);
    }

    init();

    /* ---------- Notes for integration ---------- */
    /*
      - Replace localStorage state with Appwrite calls: store users collection with fields (telegram_id, wallet_address, totalMined, dailyMined, miningSpeedPerSec, lastClaimAt, streak, tasksCompleted, upgradeExpiry)
      - Replace simulated payment flow with an on-chain verification: user sends 0.0009 BNB to your project address, backend verifies tx hash & amount, then sets miningSpeedPerSec to upgraded value and expiry.
      - Task verification: use Telegram Bot API to verify channel membership, or require proof (tx hash, screenshot) and verify server-side.
      - For Telegram WebApp: use Telegram.WebApp.initData and initDataUnsafe to get telegram user object & prefill referral links.
      - Security: don't trust client for awarding coins. Always validate & credit server-side.
    */
  </script></body>
</html>